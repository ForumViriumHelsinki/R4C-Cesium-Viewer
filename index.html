<!DOCTYPE html>
<html lang="en">
<head>
<title>R4C demo</title>
  <meta charset="utf-8">
  <!-- Include the CesiumJS JavaScript and CSS files -->
  <script src="lib/Cesium/Cesium.js"></script>
  <script type="text/javascript" src="services/geoapitools.js"></script>
  <script type="text/javascript" src="services/buildings.js"></script>
  <script type="text/javascript" src="services/vegetation.js"></script>
  <script type="text/javascript" src="services/othernature.js"></script>
  <script type="text/javascript" src="services/sliderevents.js"></script>
  <script type="text/javascript" src="services/selectevents.js"></script>
  <script type="text/javascript" src="services/urbanheat.js"></script>
  <script type="text/javascript" src="services/featurepicker.js"></script>
  <script type="text/javascript" src="services/floods.js"></script>
  <script type="text/javascript" src="services/geocoding.js"></script>
  <script type="text/javascript" src="services/trees.js"></script>
  <script type="text/javascript" src="services/plots.js"></script>
  <script type="text/javascript" src="services/decoding.js"></script>
  <script type="text/javascript" src="services/sensors.js"></script>
  <script src="lib/localforage/dist/localforage.js"></script>
  <script src="lib/plotly-2.12.1.min.js"></script>
  <link href="lib/Cesium/Widgets/widgets.css" rel="stylesheet">
  <link href="styles/demoapp.css" rel="stylesheet">
</head>
<body>
<div id="canvasScalerDiv">
  <div id="cesiumContainer"></div>
  <div id="UIContainer">
  <p class="header">R4C Urban Heat risk demonstrator</p>
  <p class="uiButton" onClick="reset()" style="color: red; float:right;">Reset</p>
  <!-- showPlotSwitch-->
<label class="switch">
  <input type="checkbox" id="showPlotToggle" value="showPlot" checked>
  <span class="slider round"></span>
</label>
<label for="showPlotToggle" class="label">Display plot</label>

  <!-- showPrintSwitch-->
<label class="switch">
  <input type="checkbox" id="printToggle" value="print" checked>
  <span class="slider round"></span>
</label>
<label for="printToggle" class="label">Object details</label>

  <!-- showVegetationSwitch-->
<label class="switch">
	<input type="checkbox" id="showVegetationToggle" value="showVegetation" >
	<span class="slider round"></span>
</label>
<label for="showVegetationToggle" class="label">Vegetation</label>

  <!-- showOtherNatureSwitch-->
<label class="switch">
  <input type="checkbox" id="showOtherNatureToggle" value="showOtherNature" >
  <span class="slider round"></span>
</label>
<label for="showOtherNatureToggle" class="label">Other nature</label>
  
  <!-- hideNonSoteSwitch-->
<label class="switch" id = "hideLowSwitch">
	<input type="checkbox" id="hideNonSoteToggle" value="hideNonSote" >
	<span class="slider round"></span>
</label>
<label for="hideNonSote" class="label">Only sote buildings</label>

  <!--  hideLowSwitch-->
<label class="switch" id = "hideLowSwitch" >
  <input type="checkbox" id="hideLowToggle" value="hideLow" >
  <span class="slider round"></span>
</label>
<label for="hideLow" class="label">Only tall buildings</label>

  <!--  showTrees-->
  <label class="switch" id = "showTreesSwitch" >
    <input type="checkbox" id="showTreesToggle" value="showTrees" >
    <span class="slider round"></span>
  </label>
  <label for="showTrees" class="label">Trees</label>

  <!--  showSensorData-->
  <label class="switch" id = "showSensorDataSwitch" >
    <input type="checkbox" id="showSensorDataToggle" value="showSensorData" >
    <span class="slider round"></span>
  </label>
  <label for="showSensorData" class="label">Sensor data</label>

    <!--  switchView-->
    <label class="switch" id = "switchViewSwitch" >
      <input type="checkbox" id="switchViewToggle" value="switchView" >
      <span class="slider round"></span>
    </label>
    <label for="switchView" class="label" id="switchViewLabel">2D view</label>

</div>

	<div id="printContainer">
  <i>Please click on a postcode area or enter location to load building and nature polygons from the WFS server...</i>
  	</div>

<div id="georefContainer">
<p class="header" style="font-size: smaller; margin: 0px;">Move to address</p>
  <div id="searchcontainer" class="container-fluid">
    <form role="search">
        <div class="form-group">
            <div class="input-group">
                <div class="input-group-addon"><span class="glyphicon glyphicon-search"></span></div>
                <input type="search" class="form-control" placeholder="enter place or address" id="searchInput" autocomplete="off" />
            </div>
          </div>
        </form>
            
<div id="searchresultscontainer" class="container-fluid hidden">
            <div class="panel-group" id="searchresults" role="tablist"></div>
      </div>
    </div>
<div id="searchbutton">
  <button class="btn btn-primary btn-block" id="searchButton">Move to target</button>
</div>
</div>

  <div id="plotContainer">
  </div>
  <div id="plotSoSContainer">
  </div>
  <div id="plotMaterialContainer">
  </div>

  <label id="bearingLabel" style="position: fixed; bottom: 41px; left: 15px; visibility: hidden;">Direction of trees</label>

  <div id="bearingAllSwitchContainer">
    <!-- bearingAll -->
    <label class="switch" id="bearingAllSwitch">
      <input type="checkbox" id="bearingAllToggle" value="a">
      <span class="slider round"></span>
    </label>
    <label for="bearingAllToggle" class="label" id="bearingAllLabel">All</label>
  </div>

  <div id="bearingSouthSwitchContainer">
    <!-- bearingSouth -->
    <label class="switch" id="bearingSouthSwitch">
      <input type="checkbox" id="bearingSouthToggle" value="s">
      <span class="slider round"></span>
    </label>
    <label for="bearingSouthToggle" class="label" id="bearingSouthLabel">South</label>
  </div>

  <div id="bearingWestSwitchContainer">
    <!-- bearingWest -->
    <label class="switch" id="bearingWestSwitch">
      <input type="checkbox" id="bearingWestToggle" value="w">
      <span class="slider round"></span>
    </label>
    <label for="bearingWestToggle" class="label" id="bearingWestLabel">West</label>
  </div>

  <div id="bearingEastSwitchContainer">
    <!-- bearingEast -->
    <label class="switch" id="bearingEastwitch">
      <input type="checkbox" id="bearingEastToggle" value="e">
      <span class="slider round"></span>
    </label>
    <label for="bearingEastToggle" class="label" id="bearingEastLabel">East</label>
  </div>

  <div id="bearingNorthSwitchContainer">
    <!-- bearingWest -->
    <label class="switch" id="bearingNorthSwitch">
      <input type="checkbox" id="bearingNorthToggle" value="n">
      <span class="slider round"></span>
    </label>
    <label for="bearingNorthToggle" class="label" id="bearingNorthLabel">North</label>
  </div>

  <select id="numericalSelect" value="numerical">
    <option value="measured_height" selected>height</option>
    <option value="c_valmpvm">age</option>
    <option value="area_m2">area</option>
    <option value="i_raktilav">volume</option>
</select>

<select id="categoricalSelect" value="categorical">
  <option value="c_julkisivu" selected>facade material</option>
  <option value="c_rakeaine">building material</option>
  <option value="roof_type">roof type</option>
  <option value="roof_median_color">roof median color</option>
  <option value="roof_mode_color">roof mode color</option>
  <option value="kayttotarkoitus">usage</option>
  <option value="tyyppi">type</option>
  <option value="c_lammtapa">heating method</option>
  <option value="c_poltaine">heating source</option>
</select>
  		<!-- Add Logo -->
		
	<div class="logoHolder">	
	<img src="assets/images/regions4climate-black.png" id="logoR4C" alt="Regions4Climate" />
	<img src="assets/images/fvh-1_musta.png" id="logoFVH" alt="Forum Virium Helsinki" />
  </div>
  
  </div>
  <script>
  
  	// UI related global variables...
  	var showPlot = true;
	  var showVegetation = false;
    var showOtherNature = false;
  	var print = true; //show object details..
	  var postalcode = null;
    var nameOfZone = null;
    var averageHeatExposure = 0;
    var averageTreeArea = 0;
	// OS version, operating without Cesium Ion services...
    Cesium.Ion.defaultAccessToken = null;

    // Initialize the Cesium Viewer in the HTML element with the `cesiumContainer` ID.
    const viewer = new Cesium.Viewer('cesiumContainer', {
    	terrainProvider : new Cesium.EllipsoidTerrainProvider(),
		  imageryProvider: createImageryProvider( 'Karttasarja_PKS' ),
    	animation: false,
      fullscreenButton: false,
      geocoder: false,
      shadows: false,
      navigationHelpButton: false,
      timeline: false,
      sceneModePicker: false,
      baseLayerPicker: false,
      infoBox: false,
	  homeButton: false
    });    
  
    // Fly the camera to Helsinki at the given longitude, latitude, and height.
    viewer.camera.flyTo({
      destination : Cesium.Cartesian3.fromDegrees( 24.931745, 60.190464, 35000 ), 
      orientation : {
        heading : Cesium.Math.toRadians(0.0),
        pitch : Cesium.Math.toRadians(-85.0),
      }
    });
    
    // Load post code zones & energy data availability tags
	loadPostCodeZones(0.2);
    
	//Experimental scripts for playing around with the objects, and retrieving their information...
	document.getElementById("cesiumContainer").addEventListener("click", function() { processClick( viewer, event ) });
	//Attaching UI events...
	addEventListener('input', ( event ) => { sliderEvents( event ) } );
  addEventListener('change', ( event ) => { selectEvents( event ) } );

  //disable switch for showing heat exposure on nature areas
  document.getElementById( "hideNonSoteToggle" ).disabled = true;
  document.getElementById( "hideLowToggle" ).disabled = true;
  document.getElementById( "switchViewToggle" ).disabled = true;
  addGeocodingEventListeners( viewer );

  // Call the function to set up the bearing switches
  setupBearingSwitches();

  const hriCredit = new Cesium.Credit('<a href="https://hri.fi/data/fi/dataset" target="_blank"><img src="assets/images/hero_logo_50x25.png" title="assets/images/Helsinki Region Infoshare"/></a>');
  const statsCredit = new Cesium.Credit('<a href="https://www.stat.fi/org/avoindata/paikkatietoaineistot_en.html" target="_blank"><img src="assets/images/tilastokeskus_en_75x25.png" title="Statistics Finland"/></a>');
  const hsyCredit = new Cesium.Credit('<a href="https://www.hsy.fi/en/air-quality-and-climate/geographic-information/open-geographic-information-interfaces/" target="_blank"><img src="assets/images/hsy-logo_41x25px.png" title="HSY"/></a>');

  viewer.scene.frameState.creditDisplay.addDefaultCredit( hriCredit );
  viewer.scene.frameState.creditDisplay.addDefaultCredit( statsCredit );
  viewer.scene.frameState.creditDisplay.addDefaultCredit( hsyCredit );

  </script>
</body>
</html>