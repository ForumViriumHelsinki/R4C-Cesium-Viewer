apiVersion: apps/v1
kind: Deployment
metadata:
  name: pygeoapi
  namespace: regions4climate
  labels:
    app: pygeoapi
spec:
  replicas: 1
  selector:
    matchLabels:
      app: pygeoapi
  template:
    metadata:
      labels:
        app: pygeoapi
    spec:
      initContainers:
        - name: wait-for-db-init
          image: postgres:15-alpine
          env:
            - name: DATABASE_URL
              value: "postgres://regions4climate_user:regions4climate_pass@postgresql:5432/regions4climate?sslmode=disable"
          command:
            - sh
            - -c
            - |
              set -e
              echo "üîç Waiting for database to be fully initialized and migrated..."

              # Wait for PostgreSQL to be ready
              echo "   Checking PostgreSQL availability..."
              until pg_isready -h postgresql -p 5432 -U regions4climate_user; do
                echo "   PostgreSQL is not ready yet. Waiting..."
                sleep 2
              done
              echo "‚úÖ PostgreSQL is ready"

              # Wait for migrations to complete by checking schema_migrations table
              echo "   Checking for completed migrations..."
              MAX_ATTEMPTS=60  # 5 minutes max wait
              ATTEMPT=1

              until [ $ATTEMPT -gt $MAX_ATTEMPTS ]; do
                # Check if schema_migrations table exists and has entries
                MIGRATION_COUNT=$(psql "$DATABASE_URL" -t -c "SELECT COUNT(*) FROM schema_migrations;" 2>/dev/null | tr -d ' \n' || true)
                # Default to 0 if empty (table doesn't exist yet)
                MIGRATION_COUNT=${MIGRATION_COUNT:-0}

                if [ "$MIGRATION_COUNT" -gt 0 ] 2>/dev/null; then
                  echo "‚úÖ Found $MIGRATION_COUNT applied migrations"

                  # Verify critical table exists
                  if psql "$DATABASE_URL" -c "SELECT 1 FROM r4c_hsy_building_current LIMIT 1;" > /dev/null 2>&1; then
                    echo "‚úÖ r4c_hsy_building_current table exists and is accessible"
                    echo "üéâ Database is fully ready for pygeoapi!"
                    exit 0
                  else
                    echo "‚ùå r4c_hsy_building_current table missing after migrations"
                    exit 1
                  fi
                fi

                echo "   Migrations not yet complete (attempt $ATTEMPT/$MAX_ATTEMPTS). Waiting..."
                sleep 5
                ATTEMPT=$((ATTEMPT + 1))
              done

              echo "‚ùå Timeout waiting for database migrations to complete"
              echo "‚ÑπÔ∏è  Check migration job logs for details"
              exit 1
      containers:
        - name: pygeoapi
          image: geopython/pygeoapi:latest
          ports:
            - containerPort: 80
          env:
            - name: PYGEOAPI_CONFIG
              value: /pygeoapi/local.config.yml
            - name: DB_HOST
              value: postgresql
            - name: DB_NAME_R4C
              value: regions4climate
            - name: DB_NAME_MED_IREN
              value: med_iren
            - name: DB_USER
              value: regions4climate_user
            - name: DB_PASSWORD
              value: regions4climate_pass
            - name: DB_PASSWORD_MED_IREN
              value: regions4climate_pass
          volumeMounts:
            - name: config
              mountPath: /pygeoapi/local.config.yml
              subPath: local.config.yml
            - name: data
              mountPath: /pygeoapi/tests/data
          resources:
            limits:
              cpu: 250m
              memory: 512Mi
            requests:
              cpu: 250m
              memory: 256Mi
          livenessProbe:
            httpGet:
              path: /
              port: 80
            initialDelaySeconds: 30
            periodSeconds: 30
            timeoutSeconds: 10
            failureThreshold: 3
          readinessProbe:
            httpGet:
              path: /collections
              port: 80
            initialDelaySeconds: 10
            periodSeconds: 10
            timeoutSeconds: 5
            failureThreshold: 3
      volumes:
        - name: config
          configMap:
            name: pygeoapi-config
        - name: data
          emptyDir: {}
---
apiVersion: v1
kind: Service
metadata:
  name: pygeoapi
  namespace: regions4climate
  labels:
    app: pygeoapi
spec:
  selector:
    app: pygeoapi
  ports:
    - port: 80
      targetPort: 80
      protocol: TCP
  type: ClusterIP
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: pygeoapi-config
  namespace: regions4climate
data:
  local.config.yml: |
    server:
        bind:
            host: 0.0.0.0
            port: 80
        url: /
        mimetype: application/json; charset=UTF-8
        encoding: utf-8
        gzip: false
        languages:
            # First language is the default language
            - en-US
            - fr-CA
        # cors: true
        pretty_print: true
        limits:  # server limits on number of items to return.  This property can also be defined at the resource level to override global server settings
          default_items: 100
          max_items: 100000
          max_distance_x: 2500
          max_distance_y: 2500
          max_distance_units: m
        # templates:
          # path: /path/to/Jinja2/templates
          # static: /path/to/static/folder # css/js/img
        map:
            url: https://tile.openstreetmap.org/{z}/{x}/{y}.png
            attribution: '&copy; <a href="https://openstreetmap.org/copyright">OpenStreetMap contributors</a>'
    #    manager:
    #        name: TinyDB
    #        connection: /tmp/pygeoapi-process-manager.db
    #        output_dir: /tmp/
        # ogc_schemas_location: /opt/schemas.opengis.net

    logging:
        level: ERROR
        #logfile: /tmp/pygeoapi.log

    metadata:
        identification:
            title:
                en: pygeoapi default instance
                fr: instance par d√©faut de pygeoapi
            description:
                en: pygeoapi provides an API to geospatial data
                fr: pygeoapi fournit une API aux donn√©es g√©ospatiales
            keywords:
                en:
                    - geospatial
                    - data
                    - api
                fr:
                    - g√©ospatiale
                    - donn√©es
                    - api
            keywords_type: theme
            terms_of_service: https://creativecommons.org/licenses/by/4.0/
            url: https://example.org
        license:
            name: CC-BY 4.0 license
            url: https://creativecommons.org/licenses/by/4.0/
        provider:
            name: Organization Name
            url: https://pygeoapi.io
        contact:
            name: Lastname, Firstname
            position: Position Title
            address: Mailing Address
            city: City
            stateorprovince: Administrative Area
            postalcode: Zip or Postal Code
            country: Country
            phone: +xx-xxx-xxx-xxxx
            fax: +xx-xxx-xxx-xxxx
            email: you@example.org
            url: Contact URL
            hours: Mo-Fr 08:00-17:00
            instructions: During hours of service. Off on weekends.
            role: pointOfContact

    resources:
        adaptation_landcover:
            type: collection
            title: HSY landcover areas used for climate adaptation
            description: This collection contains HSY landcover areas used for climate adaptation in R4C demo.
            keywords:
                - Climate Adaptation
                - Uusimaa
                - Urban Heat
                - HSY
            links:
                - type: text/html
                  rel: canonical
                  title: data
                  href:
                  hreflang: en-US
            extents:
                spatial:
                    bbox: [22.7497,59.689,26.65,60.84]
                    crs: http://www.opengis.net/def/crs/OGC/1.3/CRS84
                temporal:
                    begin: 2000-10-30T18:24:39Z
                    end: 2028-10-30T08:57:29Z
            providers:
                - type: feature
                  name: PostgreSQL
                  data:
                    host: ${DB_HOST}
                    dbname: ${DB_NAME_R4C}
                    user: ${DB_USER}
                    password: ${DB_PASSWORD}
                  id_field: id
                  table: adaptation_landcover
                  geom_field: geom

        hsy_buildings:
            type: collection
            title: Buildings with Average Urban Heat Exposure
            description: This collection contains HSY area buildings with Average Urban Heat Exposure indicator.
            keywords:
                - Buildings
                - Uusimaa
                - Urban Heat
                - HSY
            links:
                - type: text/html
                  rel: canonical
                  title: data
                  href:
                  hreflang: en-US
            extents:
                spatial:
                    bbox: [22.7497,59.689,26.65,60.84]
                    crs: http://www.opengis.net/def/crs/OGC/1.3/CRS84
                temporal:
                    begin: 2000-10-30T18:24:39Z
                    end: 2023-10-30T08:57:29Z
            providers:
                - type: feature
                  name: PostgreSQL
                  data:
                    host: ${DB_HOST}
                    dbname: ${DB_NAME_R4C}
                    user: ${DB_USER}
                    password: ${DB_PASSWORD}
                  id_field: vtj_prt
                  table: r4c_hsy_building
                  geom_field: geom

        coldarea:
            type: collection
            title: Cold areas
            description: This collection contains Capital Region areas that have heatexposure index 0.4 or less
            keywords:
                - Heat Exposure
                - Uusimaa
                - Urban Heat
                - Capital Region
            links:
                - type: text/html
                  rel: canonical
                  title: data
                  href:
                  hreflang: en-US
            extents:
                spatial:
                    bbox: [22.7497,59.689,26.65,60.84]
                    crs: http://www.opengis.net/def/crs/OGC/1.3/CRS84
                temporal:
                    begin: 2000-10-30T18:24:39Z
                    end: 2023-10-30T08:57:29Z
            providers:
                - type: feature
                  name: PostgreSQL
                  data:
                    host: ${DB_HOST}
                    dbname: ${DB_NAME_R4C}
                    user: ${DB_USER}
                    password: ${DB_PASSWORD}
                  id_field: id
                  table: r4c_coldspot
                  geom_field: geom

        urban_heat_building:
            type: collection
            title: Buildings with Average Urban Heat Exposure
            description: This collection contains health and social care buildings with Average Urban Heat Exposure indicator.
            keywords:
                - Buildings
                - Uusimaa
                - Urban Heat
                - Exposure
            links:
                - type: text/html
                  rel: canonical
                  title: data
                  href:
                  hreflang: en-US
            extents:
                spatial:
                    bbox: [22.7497,59.689,26.65,60.84]
                    crs: http://www.opengis.net/def/crs/OGC/1.3/CRS84
                temporal:
                    begin: 2000-10-30T18:24:39Z
                    end: 2023-10-30T08:57:29Z
            providers:
                - type: feature
                  name: PostgreSQL
                  data:
                    host: ${DB_HOST}
                    dbname: ${DB_NAME_R4C}
                    user: ${DB_USER}
                    password: ${DB_PASSWORD}
                  id_field: id
                  table: urban_heat_building_f
                  geom_field: geom

        tree:
            type: collection
            title: Trees
            description: This collection contains information of trees from Helsinki region land cover dataset.
            keywords:
                - HSY
                - Helsinki
                - Green area
                - Tree
            links:
                - type: text/html
                  rel: canonical
                  title: data
                  href:
                  hreflang: en-US
            extents:
                spatial:
                    bbox: [22.7497,59.689,26.65,60.84]
                    crs: http://www.opengis.net/def/crs/OGC/1.3/CRS84
                temporal:
                    begin: 2000-10-30T18:24:39Z
                    end: 2023-10-30T08:57:29Z
            providers:
                - type: feature
                  name: PostgreSQL
                  data:
                    host: ${DB_HOST}
                    dbname: ${DB_NAME_R4C}
                    user: ${DB_USER}
                    password: ${DB_PASSWORD}
                  id_field: id
                  table: tree_f
                  geom_field: geom

        vegetation:
            type: collection
            title: Vegetation
            description: This collection contains information of green areas from Helsinki region land cover dataset.
            keywords:
                - HSY
                - Helsinki
                - Green area
                - Land cover
            links:
                - type: text/html
                  rel: canonical
                  title: data
                  href:
                  hreflang: en-US
            extents:
                spatial:
                    bbox: [22.7497,59.689,26.65,60.84]
                    crs: http://www.opengis.net/def/crs/OGC/1.3/CRS84
                temporal:
                    begin: 2000-10-30T18:24:39Z
                    end: 2023-10-30T08:57:29Z
            providers:
                - type: feature
                  name: PostgreSQL
                  data:
                    host: ${DB_HOST}
                    dbname: ${DB_NAME_R4C}
                    user: ${DB_USER}
                    password: ${DB_PASSWORD}
                  id_field: id
                  table: nature_area_f
                  geom_field: geom

        hki_roof_colors:
            type: collection
            title: Helsinki building roof colors
            description: This collection contains information of the colors of the roofs of buildings in the city of Helsinki, Finland.
            keywords:
                - Helsinki
                - Roof
                - R4C
            links:
                - type: text/html
                  rel: canonical
                  title: data
                  href:
                  hreflang: en-US
            extents:
                spatial:
                    bbox: [22.7497,59.689,26.65,60.84]
                    crs: http://www.opengis.net/def/crs/OGC/1.3/CRS84
                temporal:
                    begin: 2000-10-30T18:24:39Z
                    end: 2023-10-30T08:57:29Z
            providers:
                - type: feature
                  name: PostgreSQL
                  data:
                    host: ${DB_HOST}
                    dbname: ${DB_NAME_R4C}
                    user: ${DB_USER}
                    password: ${DB_PASSWORD}
                  id_field: hki_id
                  table: hki_roof_colors_f
                  geom_field: geom

        hsy_buildings_optimized:
            type: collection
            title: Buildings with Average Urban Heat Exposure (Optimized)
            description: This collection contains HSY area buildings with Average Urban Heat Exposure indicator from optimized materialized view.
            keywords:
                - Buildings
                - Uusimaa
                - Urban Heat
                - HSY
                - Optimized
            links:
                - type: text/html
                  rel: canonical
                  title: data
                  href:
                  hreflang: en-US
            extents:
                spatial:
                    bbox: [22.7497,59.689,26.65,60.84]
                    crs: http://www.opengis.net/def/crs/OGC/1.3/CRS84
                temporal:
                    begin: 2000-10-30T18:24:39Z
                    end: 2023-10-30T08:57:29Z
            providers:
                - type: feature
                  name: PostgreSQL
                  data:
                    host: ${DB_HOST}
                    dbname: ${DB_NAME_R4C}
                    user: ${DB_USER}
                    password: ${DB_PASSWORD}
                  id_field: vtj_prt
                  table: r4c_hsy_building_mat
                  geom_field: geom

        heatexposure_optimized:
            type: collection
            title: Capital Region Postal Codes with Urban Heat Exposure (Optimized)
            description: This collection contains capital region postal code areas with average urban heat exposure from optimized materialized view.
            keywords:
                - Tilastokeskus
                - Uusimaa
                - Urban Heat
                - HSY
                - Optimized
            links:
                - type: text/html
                  rel: canonical
                  title: data
                  href:
                  hreflang: en-US
            extents:
                spatial:
                    bbox: [22.7497,59.689,26.65,60.84]
                    crs: http://www.opengis.net/def/crs/OGC/1.3/CRS84
                temporal:
                    begin: 2000-10-30T18:24:39Z
                    end: 2023-10-30T08:57:29Z
            providers:
                - type: feature
                  name: PostgreSQL
                  data:
                    host: ${DB_HOST}
                    dbname: ${DB_NAME_R4C}
                    user: ${DB_USER}
                    password: ${DB_PASSWORD}
                  id_field: postinumero
                  table: r4c_postalcode_mat
                  geom_field: geom

        tree_building_distance:
            type: collection
            title: Tree Building distance
            description: This collection contains the distance between trees and buildings city of Helsinki, Finland.
            keywords:
                - Helsinki
                - Trees
                - R4C
            links:
                - type: text/html
                  rel: canonical
                  title: data
                  href:
                  hreflang: en-US
            extents:
                spatial:
                    bbox: [22.7497,59.689,26.65,60.84]
                    crs: http://www.opengis.net/def/crs/OGC/1.3/CRS84
                temporal:
                    begin: 2000-10-30T18:24:39Z
                    end: 2023-10-30T08:57:29Z
            providers:
                - type: feature
                  name: PostgreSQL
                  data:
                    host: ${DB_HOST}
                    dbname: ${DB_NAME_R4C}
                    user: ${DB_USER}
                    password: ${DB_PASSWORD}
                  id_field: id
                  table: tree_building_distance
                  geom_field: geom

        hki_travel_time:
            type: collection
            title: Helsinki travel times
            description: This collection contains greatly simplified Helsinki travel time matrix. Only average travel times are included in the data.
            keywords:
                - Helsinki
                - Travel Time Matrix
                - R4C
            links:
                - type: text/html
                  rel: canonical
                  title: data
                  href:
                  hreflang: en-US
            extents:
                spatial:
                    bbox: [22.7497,59.689,26.65,60.84]
                    crs: http://www.opengis.net/def/crs/OGC/1.3/CRS84
                temporal:
                    begin: 2000-10-30T18:24:39Z
                    end: 2023-10-30-30T08:57:29Z
            providers:
                - type: feature
                  name: PostgreSQL
                  data:
                    host: ${DB_HOST}
                    dbname: ${DB_NAME_R4C}
                    user: ${DB_USER}
                    password: ${DB_PASSWORD}
                  id_field: id
                  table: hki_travel_time_r4c_f
                  geom_field: geom

        othernature:
            type: collection
            title: Nature area
            description: This collection contains information of other nature areas from Helsinki region land cover dataset.
            keywords:
                - HSY
                - Helsinki
                - Rocks
                - Land cover
            links:
                - type: text/html
                  rel: canonical
                  title: data
                  href:
                  hreflang: en-US
            extents:
                spatial:
                    bbox: [22.7497,59.689,26.65,60.84]
                    crs: http://www.opengis.net/def/crs/OGC/1.3/CRS84
                temporal:
                    begin: 2000-10-30T18:24:39Z
                    end: 2023-10-30T08:57:29Z
            providers:
                - type: feature
                  name: PostgreSQL
                  data:
                    host: ${DB_HOST}
                    dbname: ${DB_NAME_R4C}
                    user: ${DB_USER}
                    password: ${DB_PASSWORD}
                  id_field: id
                  table: other_nature_r4c
                  geom_field: geom

        populationgrid:
            type: collection
            title: HSY population grid land cover
            description: HSY population grid with HSY land cover data
            keywords:
                - landcover
                - Helsinki
                - HSY
            links:
                - type: text/html
                  rel: canonical
                  title: data
                  href:
                  hreflang: en-US
            extents:
                spatial:
                    bbox: [24.80, 60.10, 25.32, 60.30]
                    crs: http://www.opengis.net/def/crs/OGC/1.3/CRS84
                temporal:
                    begin: 2000-10-30T18:24:39Z
                    end: 2024-10-30T08:57:29Z
            providers:
              - type: feature
                name: GeoJSON
                data: tests/data/populationgrid.json
                id_field: index

        capitalregion_postalcode:
            type: collection
            title: Helsinki Capital Region postalcodes with land cover
            description: Helsinki Capital Region postalcodes with HSY land cover data
            keywords:
                - landcover
                - Helsinki
                - HSY
            links:
                - type: text/html
                  rel: canonical
                  title: data
                  href:
                  hreflang: en-US
            extents:
                spatial:
                    bbox: [24.80, 60.10, 25.32, 60.30]
                    crs: http://www.opengis.net/def/crs/OGC/1.3/CRS84
                temporal:
                    begin: 2000-10-30T18:24:39Z
                    end: 2024-10-30T08:57:29Z
            providers:
              - type: feature
                name: GeoJSON
                data: tests/data/hsy_po.json
                id_field: posno

        heatexposure:
            type: collection
            title: Capital Region Postal Codes with Urban Heat Exposure
            description: This collection contains capital region postal code areas with average urban heat exposure
            keywords:
                - Tilastokeskus
                - Uusimaa
                - Urban Heat
                - HSY
            links:
                - type: text/html
                  rel: canonical
                  title: data
                  href:
                  hreflang: en-US
            extents:
                spatial:
                    bbox: [22.7497,59.689,26.65,60.84]
                    crs: http://www.opengis.net/def/crs/OGC/1.3/CRS84
                temporal:
                    begin: 2000-10-30T18:24:39Z
                    end: 2023-10-30T08:57:29Z
            providers:
                - type: feature
                  name: PostgreSQL
                  data:
                    host: ${DB_HOST}
                    dbname: ${DB_NAME_R4C}
                    user: ${DB_USER}
                    password: ${DB_PASSWORD}
                  id_field: postinumero
                  table: r4c_postalcode
                  geom_field: geom

        specific_places:
            type: collection
            title: Espoo specific places
            description: Espoo on the map resident survey specific places with heat exposure
            keywords:
                - Espoo
                - Resident
                - Survey
            links:
                - type: text/html
                  rel: canonical
                  title: data
                  href:
                  hreflang: en-US
            extents:
                spatial:
                    bbox: [24.80, 60.10, 25.32, 60.30]
                    crs: http://www.opengis.net/def/crs/OGC/1.3/CRS84
                temporal:
                    begin: 2000-10-30T18:24:39Z
                    end: 2024-10-30T08:57:29Z
            providers:
              - type: feature
                name: GeoJSON
                data: tests/data/ErityisetPaikat_with_ndvi.geojson
                id_field: fid

        places_in_everyday_life:
            type: collection
            title: Espoo places in everyday life
            description: Espoo on the map resident survey places in everyday life with heat exposure
            keywords:
                - Espoo
                - Resident
                - Survey
            links:
                - type: text/html
                  rel: canonical
                  title: data
                  href:
                  hreflang: en-US
            extents:
                spatial:
                    bbox: [24.80, 60.10, 25.32, 60.30]
                    crs: http://www.opengis.net/def/crs/OGC/1.3/CRS84
                temporal:
                    begin: 2000-10-30T18:24:39Z
                    end: 2024-10-30T08:57:29Z
            providers:
              - type: feature
                name: GeoJSON
                data: tests/data/ArjenPaikat_with_ndvi.geojson
                id_field: fid

        suitable_places_for_construction:
            type: collection
            title: Espoo suitable places for construction
            description: Espoo on the map resident survey suitable places for construction with heat exposure
            keywords:
                - Espoo
                - Resident
                - Survey
            links:
                - type: text/html
                  rel: canonical
                  title: data
                  href:
                  hreflang: en-US
            extents:
                spatial:
                    bbox: [24.80, 60.10, 25.32, 60.30]
                    crs: http://www.opengis.net/def/crs/OGC/1.3/CRS84
                temporal:
                    begin: 2000-10-30T18:24:39Z
                    end: 2024-10-30T08:57:29Z
            providers:
              - type: feature
                name: GeoJSON
                data: tests/data/RakentamisenPaikat_with_ndvi.geojson
                id_field: fid

        centers:
            type: collection
            title: Espoo centers
            description: Espoo on the map resident survey centers with heat exposure
            keywords:
                - Espoo
                - Resident
                - Survey
            links:
                - type: text/html
                  rel: canonical
                  title: data
                  href:
                  hreflang: en-US
            extents:
                spatial:
                    bbox: [24.80, 60.10, 25.32, 60.30]
                    crs: http://www.opengis.net/def/crs/OGC/1.3/CRS84
                temporal:
                    begin: 2000-10-30T18:24:39Z
                    end: 2024-10-30T08:57:29Z
            providers:
              - type: feature
                name: GeoJSON
                data: tests/data/Keskukset_with_ndvi.geojson
                id_field: fid

        development_ideas:
            type: collection
            title: Espoo development ideas
            description: Espoo on the map resident survey development ideas with heat exposure
            keywords:
                - Espoo
                - Resident
                - Survey
            links:
                - type: text/html
                  rel: canonical
                  title: data
                  href:
                  hreflang: en-US
            extents:
                spatial:
                    bbox: [24.80, 60.10, 25.32, 60.30]
                    crs: http://www.opengis.net/def/crs/OGC/1.3/CRS84
                temporal:
                    begin: 2000-10-30T18:24:39Z
                    end: 2024-10-30T08:57:29Z
            providers:
              - type: feature
                name: GeoJSON
                data: tests/data/Kehittamisideat_with_ndvi.geojson
                id_field: fid

        # NOTE: ndvi_timeseries and tree_spotted collections disabled - require med_iren database tables
        # ndvi_timeseries:
        #     type: collection
        #     title: Helsinki MajorDistrict NDVI timeseries
        #     description:
        #     keywords:
        #         - NDVI
        #         - Satellite data
        #         - Timeseries
        #     links:
        #         - type: text/html
        #           rel: canonical
        #           title: data
        #           href:
        #           hreflang: en-US
        #     extents:
        #         spatial:
        #             bbox: [24.80, 60.10, 25.32, 60.30]
        #             crs: http://www.opengis.net/def/crs/OGC/1.3/CRS84
        #     temporal:
        #             begin: 2016-10-30T18:24:39Z
        #             end: 2024-10-30T08:57:29Z
        #     providers:
        #         - type: feature
        #           name: PostgreSQL
        #           data:
        #             host: ${DB_HOST}
        #             dbname: ${DB_NAME_MED_IREN}
        #             user: ${DB_USER}
        #             password: ${DB_PASSWORD_MED_IREN}
        #           id_field: id
        #           table: spotted_ndvi_range
        #           geom_field: geom

        # tree_spotted:
        #     type: collection
        #     title: Trees
        #     description: This collection contains information of trees from Helsinki region land cover dataset. The major district information is added from City of Helsinki data.
        #     keywords:
        #         - HSY
        #         - Tree
        #         - Green area
        #         - Land cover
        #     links:
        #         - type: text/html
        #           rel: canonical
        #           title: data
        #           href:
        #           hreflang: en-US
        #     extents:
        #         spatial:
        #             bbox: [24.80, 60.10, 25.32, 60.30]
        #             crs: http://www.opengis.net/def/crs/OGC/1.3/CRS84
        #         temporal:
        #             begin: 2000-10-30T18:24:39Z
        #             end: 2023-10-30T08:57:29Z
        #     providers:
        #         - type: feature
        #           name: PostgreSQL
        #           data:
        #             host: ${DB_HOST}
        #             dbname: ${DB_NAME_MED_IREN}
        #             user: ${DB_USER}
        #             password: ${DB_PASSWORD_MED_IREN}
        #           id_field: id
        #           table: hsy_tree_spotted
        #           geom_field: geom
