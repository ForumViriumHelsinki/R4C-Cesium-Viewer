import json

def load_geojson(file_path):
    with open(file_path, 'r') as f:
        return json.load(f)

def save_geojson(data, file_path):
    with open(file_path, 'w') as f:
        json.dump(data, f)

def drop_all_but_grid_id(features):
    # Drop all properties except 'grid_id'
    for feature in features:
        grid_id = feature['properties'].get('grid_id')
        feature['properties'] = {'grid_id': grid_id}
    return features

def combine_geojsons(main_geojson, na_geojson):
    # Combine features from both GeoJSON files
    main_geojson['features'].extend(na_geojson['features'])
    return main_geojson

def main():
    # File paths
    na_geojson_path = 'h2906_wgs84_na.geojson'
    main_geojson_path = 'r4c_stats_grid_with_index.json'
    
    # Load the GeoJSON files
    na_geojson = load_geojson(na_geojson_path)
    main_geojson = load_geojson(main_geojson_path)
    
    # Drop all properties except 'grid_id' from na_geojson
    na_geojson['features'] = drop_all_but_grid_id(na_geojson['features'])
    
    # Combine the features
    combined_geojson = combine_geojsons(main_geojson, na_geojson)
    
    # Save the combined GeoJSON back to the output file
    save_geojson(combined_geojson, main_geojson_path)
    print(f"Combined GeoJSON saved to {main_geojson_path}")

if __name__ == "__main__":
    main()